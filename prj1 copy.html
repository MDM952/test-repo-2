<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Projekt I ğŸŒ</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css\modal.css">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <link rel="icon" href="C:\Users\konra\Documents\WÅ‚asne\Programowanie\HTML CSS Javascript Course\Web Developement 15\6 - Bootstrap Tindog\css\favicon.ico">
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

        

      </head>
  <body>
      
    <section class="jumbotron text-center" id="top">
      <div class="container", style="padding: 40px;">
        <h2>Model przewidujÄ…cy ceny mieszkaÅ„ w Warszawie z uwzglÄ™dnieniem odlegÅ‚oÅ›ci</h2>
        <p class="lead text-muted">
          Autorski projekt z wÅ‚asnorÄ™cznie zebranymi danymi. 
          <br>
          Wizualizacja, analiza danych, przetwarzanie danych przestrzennych w QGIS, nauczanie maszynowe.<br>
        </p>

        <div style="height: 40px;"></div>

        <div class="container">
          <div class="row justify-content-md-center">
            <div class="col col-lg-4">
              <div class="accordion" id="accordionPanelsStayOpenExample" style="width: 450px;">
                <div class="accordion-item">
                  <h2 class="accordion-header" style="margin: auto;">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#panelsStayOpen-collapseTwelve" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwelve">
                    Kontakt â†´
                    </button>
                  </h2>
                  <div id="panelsStayOpen-collapseTwelve" class="accordion-collapse collapse" style="margin-top: 20px; margin-bottom: 20px">
                    <div class="accordion-body" style="padding: 5px" >
  <!-- The text field -->
  
                        <div class="container">
                          <div class="row" style="padding:0px">
                            <div class="col">

                              <div style="margin: auto; padding: auto;">
                                <input type="text" 
                                id="myInput" 
                                class="form-control form-control-sm" 
                                value="konrad.jarominiak0@gmail.com" disabled
                               style="width: 220px">
                              </div>


                            </div>
                            <div class="col">

                              <div style="margin: auto; padding: auto;">
                                <button type="button" class="btn btn-outline-secondary btn-sm" style="width: 140px; margin: 0;" onclick="myFunction()">skopiuj do schowka</button>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <div style="width: 220px; margin-top: 10px;">
                                <a
                                href="https://www.linkedin.com/in/konrad-jarominiak-941ba0294/"
                                class="btn btn-outline-primary btn-sm"
                                style="width: 120px; border-color: #0a66c2; "
                                >
                                LinkedIn
                                </a>
                              </div>

                              </div>
                            <div class="col">
                               
                            </div>
                          </div>
                        </div>
  
  
  
  
  <!-- The button used to copy the text -->
  
  
  <!-- The toast -->
                        <div aria-live="polite" aria-atomic="true" style="position: relative; min-height: 0px;">
                          <div class="toast" style="position: absolute; top: 0px; right: 0; width:250px">
                            <div class="toast-body">
                              Skopiowano do schowka!
                            </div>
                          </div>
                        </div>
                        
                    </div>
                  </div>
                </div>
    
              </div>   
            </div>

            <div class="col col-lg-4">
              

              <div style="width: 450px; padding-top: 15px; padding-bottom: 15px;">
                <a
                href="index.html"
                class="btn btn-secondary my-2"
                >PowrÃ³t do strony gÅ‚Ã³wnej</a>
              </div>

            </div>
          </div>
        </div>


        <div class="true_center">
          <div class="row" style="margin:margin-top: 40px; width: 100%">
            <div class="col col-sm">
           </div>
            <div class="col col-sm">

            </div>
          </div>
        </div>





        

      </div>
  </section>

    <span class="border border-0">

    <div class="container">
      <div class="row">
        <div class="col-md-9">

          <div class="tresc wstep">
            <h4 id="wstep-header">1. WstÄ™p</h4>
            Niniejszy projekt data science ma na celu przedstawienie prostego sposobu na wykorzystanie danych przestrzennych w modelowaniu data science.
            W projekcie sprawdzono jak duÅ¼e znaczenie odgrywa odlegÅ‚oÅ›Ä‡ mieszkania do centrum miasta i
             do najbliÅ¼szej stacji metra na rynku mieszkaniowym w Warszawie. 
            W projekcie wykorzystano:
<li>Selenium i Beautiful Soup w celu zebrania danych</li>
<li>SQLAlchemy do przechowania danych w bazie danych</li>
<li>GIS do wyznaczenia odlegÅ‚oÅ›ci oraz przedstawienia mieszkaÅ„ z zebranych ofert na mapie Warszawy</li>
<li>Pandas do przetworzenia i oczyszczenia danych</li>
<li>Matplotlib i Seaborn do wizualizacji danych</li>
<li>sci-kit learn i TensorFlow Keras do stworzenia modeli</li>

          </div>

          <div class="tresc zebranie_danych">
            <h4 id="zebranie_danych-header">2. Zebranie danych</h4>

            Do zebrania danych wstÄ™pnych danych wykorzystano Selenium webdriver, czyli narzÄ™dzie umoÅ¼lwiajÄ…ce zautomatyzowanie funkcjonalnoÅ›ci przeglÄ…darki. 
            WstÄ™pne dane (indeksy, linki i powiat) zebrano z pewnej strony z ofertami mieszkaÅ„ z wynikami dla Warszawy. 
            Wykorzystano tu Selenium ze wzglÄ™du na fakt, Å¼e oferty Å‚adowane sÄ… wraz z przewijaniem strony przez uÅ¼ytkownika â€“ Beautiful Soup nie wyÅ‚apaÅ‚oby Å¼adnych ofert.
            Dane przechowano przy pomocy SQLAlchemy:
            <pre><code> <!-- Kod bazy danych -->
class Links(Base):  
    __tablename__ = "Links"  
    numer = Column("numer", Integer, primary_key=True)  
    powiat = Column("powiat", String)  
    link = Column("link", String)  

    def __init__(self, numer, powiat, link):  
        self.numer = numer  
        self.link = link  
        self.powiat = powiat  

    def __repr__(self):  
        return f"({self.numer}, {self.powiat}, {self.link})"
            </code></pre>
            W sumie uzyskano 3600 linkÃ³w, z czego czÄ™Å›Ä‡ zawieraÅ‚a linki do ofert poza WarszawÄ…, 
            ktÃ³re uwzglÄ™dniono w mapie utworzonej w QGIS.
            <br>
            Do zebrania szczegÃ³Å‚owych danych rÃ³wnieÅ¼ zastosowano Selenium. 
            Web scraping przy pomocy Beautiful Soup byÅ‚by szybszy i o wiele prostszy, ale nie umoÅ¼liwiÅ‚by zebrania wspÃ³Å‚rzÄ™dnych z zaembedowanej mapy google. 
            Bez przewijania strony, poniÅ¼sza mapa nie byÅ‚aby widoczna i moÅ¼liwa do zescrapowania.
            <img src="css\p1_images\embed mapy googli.png" style="margin: 36px; ;">
            <br>
            Zbierania wspÃ³Å‚rzÄ™dnych dokonywano przy pomocy poniÅ¼szego kodu:
            <pre><code> <!-- Kod dla zbierania LATT LONG-->
try:  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )  
except NoSuchElementException:  
    driver.refresh()  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )
# ...
map_link = driver.find_element(By.XPATH, "//a[contains(@href,'apiv3')]")  
coord = map_link.get_attribute('href').split('ll=')[1].split('&')[0].split(',')  
coord_dict = {  
    'lat': float(coord[0]),  
    'long': float(coord[1])  
    }  
            </code></pre>
            PozostaÅ‚e dane zbierane byÅ‚y gÅ‚Ã³wnie w nastÄ™pujÄ…cy sposÃ³b: dla kaÅ¼dego elementu z listy `all_topics` zbierano wartoÅ›Ä‡ z tabeli szczegÃ³Å‚Ã³w na stronie. 
            W przykÅ‚adzie dla gÅ‚Ã³wnych informacji nie zdarzaÅ‚o siÄ™ aby funkcja separujÄ…ca dane z tekstu zwracaÅ‚a wartoÅ›Ä‡ `None`, zamiast tego zwracaÅ‚a 'Zapytaj' 
            gdy danych nie doprecyzowano. W sekcji oczyszczania danych te dane zostaÅ‚y poprawione i zastÄ…pione. 
            <br>
            <pre><code> <!-- Kod dla zbierania danych gÅ‚Ã³wnych -->
def separate_value(text, topic):  
    try:  
        value = text.find_element(By.CSS_SELECTOR, f'div[aria-label="{topic}"]')  
        value = value.text.split(topic)[1].replace('\n', '')  
        return value  
    except NoSuchElementException:  
        return None  
  
  
all_topics = ["Powierzchnia", "Liczba pokoi", "PiÄ™tro", "Powierzchnia dziaÅ‚ki", 
              "Czynsz", "Forma wÅ‚asnoÅ›ci", "Stan wykoÅ„czenia",  
              "Balkon / ogrÃ³d / taras", "Miejsce parkingowe", "Ogrzewanie"]  
  
try:  
    main_info_dict = driver.find_element(By.CSS_SELECTOR, 'div[data-testid="ad.top-information.table"]')  
except NoSuchElementException:  
    driver.refresh()  
    collect_info(link, numer)  
    return  
  
main_dict = {}  
for topic in all_topics:  
    main_dict[topic] = separate_value(main_info_dict, topic)
            </code></pre>
            WÅ›rÃ³d wszystkich ofert znalazÅ‚a siÄ™ niemaÅ‚a iloÅ›Ä‡ ofert deweloperÃ³w, wÅ›rÃ³d ktÃ³rych nie zostaÅ‚y podane Å¼adne dane z informacji dodatkowych, 
            np. rynek wtÃ³rny/pierwotny, winda czy rodzaj zabudowy. Te dane rÃ³wnieÅ¼ uzupeÅ‚niono w sekcji oczyszczania danych.

            Zapisania danych ofert dokonano w ten sam sposÃ³b co przy zbieraniu samych ofert i daÅ‚o poniÅ¼szÄ… tabelÄ™, wyÅ›wietlanÄ… w SQLLiteStudio:
            <br><br>
            <img src="css\p1_images\SQL dane szczegÃ³Å‚owe.png" style="width: 98%;">
          </div>

          <div class="tresc przetworzenie_w_QGIS">
            <h4 id="QGIS-header">3. Mapa i przetworzenie danych w QGIS</h4>
            TabelÄ™ zawierajÄ…cÄ… szczegÃ³Å‚owe dane zaÅ‚adowano do programu QGIS wraz warstwÄ… dzielnic Warszawy oraz stacji metra. 
            Do wyznaczenia odlegÅ‚oÅ›ci wykorzystano dwa narzÄ™dzia wektorowe: 
            <li>
            liniowa odlegÅ‚oÅ›Ä‡ do najbliÅ¼szego huba, do obliczenia odlegÅ‚oÅ›ci do centrum Warszawy 
            (na potrzeby tego projektu uznano stacjÄ™ ÅšwiÄ™tokrzyskÄ… za centrum)
            </li>
            <li>
            macierz odlegÅ‚oÅ›ci do obliczenia odlegÅ‚oÅ›ci do najbliÅ¼szej stacji metra, 
            tu obliczono odlegÅ‚oÅ›ci do najbliÅ¼szych piÄ™ciu, a nastÄ™pnie przefiltrowano tabelÄ™
            </li>
            Efektem przetworzenia danych w QGIS jest mapa mieszkaÅ„ oraz dwie nowe kolumny z odlegÅ‚oÅ›ciami, ktÃ³re zostaÅ‚y wykorzystane w modelowaniu. 
            Kilka mieszkaÅ„ w okolicach Ursynowa nie zostaÅ‚o poprawnie przefiltrowanych, niemniej nie powinny mieÄ‡ one znaczenia, ze wzglÄ™du na ich nieduÅ¼Ä… odlegÅ‚oÅ›Ä‡ od stacji metra.
          
            <br><br>


            <img class="myImg" src="css\p1_images\Warszawa.png"  style="width: 95%;">
            <div id="myModal" class="modal">
              <div class="opacity-background close">
                <span class="close">&times;</span>
              </div>
              <img class="modal-content" id="img01">
              <div id="caption"></div>
            </div>


          </div>

          <div class="tresc oczyszczenie_danych">
            <h4 id="pandas-header">4. Oczyszczenie danych w Pandas</h4>
            WstÄ™pne sprawdzenie rodzaju danych w tabeli przedstawia siÄ™ nastÄ™pujÄ…co:
            <pre><code class="language-python"> <!-- kod typy danych -->
              numer int64 
              link object 
              Cena int64 
              powierzchnia object 
              powierzchnia_dzialki float64 
              lokalizacja object 
              n_pokojow int64 pietro object 
              czynsz object 
              wlasnosc object 
              wykonczenie object 
              zewnatrz object # taras, ogrÃ³d, balkon
              parking object 
              ogrzewanie object 
              rynek object 
              ogloszenie object 
              rok_budowy object 
              zabudowa object 
              winda object 
              latt float64 
              long float64 
              Dystans do Swietokrzyskiej float64 
              najblizsza stacja object 
              dystans do najblizszej stacji [m] float64
              dtype: object
            </code></pre>

            Oczyszczenie danych polegaÅ‚o na:
            <ol>
              <li>
                Zamianie wartoÅ›ci na dane liczbowe, w przypadku kolumn takich jak cena czy powierzchnia wymagaÅ‚o usuniÄ™cia elementÃ³w z tektstu takich jak mÂ², 
                zamianie przecinkÃ³w na kropki i ogÃ³lnÄ… zmianÄ™ typu danych na int i float
              </li>
              <li>
                Zamianie pÃ³l z 'Zapytaj' i NaN czyli niereprezentowalnych brakujÄ…cych wartoÅ›ci na 
                takie ktÃ³re miaÅ‚y sens w kontekÅ›cie tabeli i danego wiersza np.:
                <pre><code class="language-python"> <!-- kod blok a winda -->
blok_a_winda = {0:None, 1:'blok'}
df['zabudowa'] = df['zabudowa'].fillna(df['winda'].map(blok_a_winda))
                </code></pre>
                Innym przykÅ‚adem uzupeÅ‚nienia danych jest wykorzystanie Beautiful Soup. 
                Przy pomocy tego scrapera sprawdzono, czy opis oferty zawiera wyraÅ¼enia takie jak 'wymaga remontu' i uzupeÅ‚niono kolumny.
                <pre><code class="language-python"> <!-- kod BS4 i remont -->
def parse_remont(link):
    response = requests.get(link, headers=HEADERS)
    soup = BeautifulSoup(response.content, 'html.parser')
    
    try:
        opis = soup.find('div',{'data-cy':'adPageAdDescription'}).text
        ad_title = soup.find('h1',{'data-cy':'adPageAdTitle'}).text
    except AttributeError: # przypadki gdy oferta zostaÅ‚a usuniÄ™ta
        return
        
    lista_remont = ['do remontu', 'wymaga remontu', 'wymagajÄ…ce remontu', 'wymagajÄ…cy remontu', 
                    'czÄ™Å›ciowego remontu', 'generalnego remontu', 
                    'caÅ‚kowitego remontu', 'do odnowy', 'do odnowienia', ]

    for r in lista_remont:
        if r in ad_title or r in opis:
            return 'do remontu'
        else:
            return 'do zamieszkania'
            
df.loc[df['wykonczenie'] == 'Zapytaj', 'wykonczenie'] 
= df.loc[df['wykonczenie'] == 'Zapytaj', 'link'].apply(lambda x: parse_remont(x))
                </code></pre>
              </li>
              <li>
                UsuniÄ™to zbÄ™dne kolumny i kolumny ze zbyt duÅ¼Ä… iloÅ›ciÄ… brakujÄ…cych danych, np. 'wÅ‚asnoÅ›Ä‡' czy 'ogÅ‚oszenie'
              </li>
              <li>
                Zastosowano OneHotEncoding przy pomocy pandas.get_dummies - z kolumny 'zabudowa' utworzono cztery nowe kolumny: 'apartamentowiec', 'blok', 'dom', 'kamienica'. JeÅ¼eli dane mieszkanie znajduje siÄ™ w bloku, w kolumnie 'blok' bÄ™dzie wartoÅ›Ä‡ 1, a w pozostaÅ‚ych 0.
                <br>
                W przypadku kolumny 'zewnÄ…trz' zastosowano wÅ‚asne funkcje do uzupeÅ‚nienia kolumn, ze wzglÄ™du na fakt, Å¼e w jednym mieszkaniu moÅ¼e wystÄ™powaÄ‡ kilka opcji np. balkon i taras jednoczeÅ›nie:
                <pre><code class="language-python"> <!-- kod dummies dla zewnÄ…trz1 -->
def get_balkon(text):
    if 'balkon' in text:
        return 1
    else:
        return 0

def get_ogrod(text):
    if 'ogrÃ³dek' in text:
        return 1
    else:
        return 0

def get_taras(text):
    if 'taras' in text:
        return 1
    else:
        return 0

df["balkon"] = df["zewnatrz"].apply(lambda x: get_balkon(x))
df["ogrod"] = df["zewnatrz"].apply(lambda x: get_ogrod(x))
df["taras"] = df["zewnatrz"].apply(lambda x: get_taras(x))
                </code></pre>                
              </li>

            </ol>



          </div>

          <div class="tresc AKORDEONY"> <!-- PoczÄ…tek wizualizacji i akordeonu -->
            <h4 id="wizualizacja-header">5. Wizualizacja danych</h4>




            
          <div class="accordion" id="accordionPanelsStayOpenExample"> 
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                  <img src="css\p1_images\Histogram cen.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6),)
ax.set_ylabel("CzÄ™stoÅ›Ä‡")
sns.histplot(df['Cena'], color='olivedrab').set_title('Histogram cen')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                  <img src="css\p1_images\PudeÅ‚kowy cen dzielnice.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-66)
chart  = sns.boxplot(data=df, y='Cena', x='lokalizacja', 
    order=df.groupby('lokalizacja').median()['Cena'].sort_values(ascending=True).index.tolist(),)
    
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pudeÅ‚kowy cen w zaleÅ¼noÅ›ci od dzielnicy')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseThree">
                  <img src="css\p1_images\PudeÅ‚kowy cen dzielnice mini.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)

chart  = sns.boxplot(data=df.drop(df[df.Cena >= 2500000].index), y='Cena', x='lokalizacja', 
    order=df.drop(df[df.Cena >= 2500000].index).groupby('lokalizacja')
    .median()['Cena'].sort_values(ascending=True).index.tolist(),
    )

f = lambda x, pos: f'{x/10**6:,.1f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))

chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pudeÅ‚kowy cen w zaleÅ¼noÅ›ci od dzielnicy')
                  </code></pre>
                </div>
              </div>
            </div>

            <li class="opis_wiz">
              NajtaÅ„sza oferta to lokal usÅ‚ugowy w WesoÅ‚ej, o powierzchni 20 mÂ², ktÃ³ry moÅ¼e peÅ‚niÄ‡ funkcjÄ™ mieszkalnÄ…, do wykoÅ„czenia, niecaÅ‚e 13 km od stacji ÅšwiÄ™tokrzyska. Niska cena wydaje siÄ™ uzasadniona.
            </li>
          </div>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFour" aria-expanded="true" aria-controls="panelsStayOpen-collapseFour">
<img src="css\p1_images\PudeÅ‚kowy powierzchni dzielnice mini.png"  alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFour" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-66)

chart  = sns.boxplot(data=df, y='powierzchnia', x='lokalizacja', 
    order=df.groupby('lokalizacja').median()['powierzchnia'].sort_values(ascending=True).index.tolist(),
    palette='tab20b'
    )

chart.set(xlabel='Dzielnica', ylabel='Powierzchnia [mÂ²]')
chart.set_title('Wykres pudeÅ‚kowy powierzchni w zaleÅ¼noÅ›ci od dzielnicy')
                                      </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFive" aria-expanded="true" aria-controls="panelsStayOpen-collapseFive">
<img src="css\p1_images\Histogram powierzchni.png" style="max-width: 100%;" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFive" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9, 6))
ax.set_ylabel("CzÄ™stoÅ›Ä‡")
chart =sns.histplot(df['powierzchnia'], bins=57, edgecolor=None, element='step', color='navy')
chart.set_title('Histogram powierzchni')
chart.set(xlabel='Powierzchnia [mÂ²]', ylabel='CzÄ™stoÅ›Ä‡')
                                      </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Wykres wyraÅºnie wspÃ³Å‚ksztaÅ‚tny do histogramu cen - wiÄ™kszoÅ›Ä‡ ofert to mieszkania do 100 mÂ² w cenie do 1-1,2 mil zÅ‚.           
          </li>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSix" aria-expanded="true" aria-controls="panelsStayOpen-collapseSix">
<img src="css\p1_images\XY sq i n pokoi.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseSix" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# Kod tylko dla lewego wykresu
chart = sns.jointplot(data=df, x='powierzchnia', y='Cena', 
                      hue='zabudowa', kind='scatter', cmap='Mako', 
ylim=(-1500000, 16000000), xlim=(-50, 500), linewidth = 0, height=8,
palette={"apartamentowiec": "slateblue", 
         "blok": "tan", 
         "kamienica": "mediumaquamarine", 
         "dom": "crimson"})
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.ax_joint.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.ax_joint.set_xlabel("Powierzchnia [mÂ²]")
chart.ax_joint.set_ylabel("Cena [zÅ‚]")
                                      </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p1_images\XY sq i dystans.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# Kolumny nie uwzglÄ™dnione w modelowaniu
df['PrzedziaÅ‚ km do ÅšwiÄ™tokrzyskiej'] = df['Dystans do Swietokrzyskiej'] / 1000
df['PrzedziaÅ‚ km do ÅšwiÄ™tokrzyskiej'] = df['PrzedziaÅ‚ km do ÅšwiÄ™tokrzyskiej'].apply(np.floor).astype('int')
df['PrzedziaÅ‚ km do najbliÅ¼szej stacji'] = df['dystans do najblizszej stacji [m]'] / 1000
df['PrzedziaÅ‚ km do najbliÅ¼szej stacji'] = df['PrzedziaÅ‚ km do najbliÅ¼szej stacji'].apply(np.floor).astype('int')
# Kod tylko dla prawego wykresu
chart = sns.jointplot(data=df, x='powierzchnia', y='Cena', hue='PrzedziaÅ‚ km do najbliÅ¼szej stacji', kind='scatter', 
              ylim=(-1500000, 16000000), xlim=(-50, 500), linewidth = 0, height=6,
              palette="mako")
f = lambda x, pos: f'{x/10**6:,.0f}M'
plt.legend(title="PrzedziaÅ‚ km do najbliÅ¼szej stacji", labels=['0-2 km', '2-5 km', '5-7 km', '10-12 km', '10-12 km'])
chart.ax_joint.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.ax_joint.set_xlabel("Powierzchnia [mÂ²]")
chart.ax_joint.set_ylabel("Cena [zÅ‚]")

                                      </code></pre>
                </div>
              </div>
            </div>
          </div>


          <li class="opis_wiz">
            Rozrzut cen w stosunku do powierzchni jest doÅ›Ä‡ znaczny, oznacza to, Å¼e na cenÄ™ rÃ³wnieÅ¼ wpÅ‚ywa wiele innych czynnikÃ³w  - 
            tu np. widaÄ‡ Å¼e aparatamenty cechujÄ… siÄ™ wyÅ¼szÄ… cenÄ… niÅ¼ inne rodzaje zabudowy, a mieszkania z dala od stacji (dzielnice WesoÅ‚a, Wawer) majÄ… wyraÅºnie niÅ¼sze ceny.
          </li>
          <li class="opis_wiz">
            Oferta mieszkania z dwoma pokojami i powierzchniÄ… 216 mÂ² to lokal mieszkalny o powierzchni 116 mÂ² wraz z lokalem usÅ‚ugowym 100 mÂ², kÃ³ry wymaga wykoÅ„czenia. 
            <br>Oferta zostaÅ‚a usuniÄ™ta pzed modelowaniem. 
          </li>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p1_images\Histogram zabudowa.png" style="max-width:100%" alt="">                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="zabudowa",
    multiple="stack",
    palette="viridis",)
chart.set_title('Rodzaj zabudowy')
chart.set(xlabel='Dzielnica', ylabel='IloÅ›Ä‡')
                  </code></pre>

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
<img src="css\p1_images\Kolumnowy stan mieszkaÅ„.png" style="max-width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="wykonczenie",
    multiple="stack",
    palette="flare",)
chart.set_title('Stan mieszkaÅ„')
chart.set(xlabel='Dzielnica', ylabel='IloÅ›Ä‡')
                  </code></pre>

                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            DuÅ¼a iloÅ›Ä‡ mieszkaÅ„ do wykoÅ„czenia na Ursusie to osiedle jednego dewelopera z liczbÄ… ok. 120 maÅ‚ych mieszkaÅ„ oznaczonych jako apartmanety.
            <br>
          </li>
<br>
          
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseTen" aria-expanded="true" aria-controls="panelsStayOpen-collapseTen">
<img src="css\p1_images\OdlegÅ‚oÅ›ci.png" style="max-width:100%" alt="">               </button>
              </h2>
              <div id="panelsStayOpen-collapseTen" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,6))
  sns.histplot(df['Dystans do Swietokrzyskiej'],  
                      label="L do stacji ÅšwiÄ™tokrzyska", 
                      kde=False, element="step", 
                      alpha=0.3)
  sns.histplot(df["dystans do najblizszej stacji [m]"],  
                      label="L do najbliÅ¼szej stacji metra [m]", 
                      kde=False, element="step", alpha=0.3)
  ax.set_title('OdlegÅ‚oÅ›ci do stacji metra')
  ax.set(xlabel='OdlegÅ‚oÅ›Ä‡ [m]', ylabel='CzÄ™stoÅ›Ä‡')
  plt.legend() 
</code></pre>                </div>
              </div>
            </div>
          </div>

<br>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine">
<img src="css\p1_images\Korelacje.png" style="max-width: 100%;">                </button>
              </h2>
              <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,8))
sns.heatmap(df.corr(), cmap='RdBu_r', annot=True, annot_kws={"fontsize":7},
    fmt=".2f",
    xticklabels=['Cena', 'Powierzchnia', 'Liczba pokojÃ³w', 'PiÄ™tro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbliÅ¼szej stacji', 'Balkon', 'OgrÃ³d', 'Taras', 'Do remontu',
    'Do wykoÅ„czenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wtÃ³rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'],
    yticklabels=['Cena', 'Powierzchnia', 'Liczba pokojÃ³w', 'PiÄ™tro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbliÅ¼szej stacji', 'Balkon', 'OgrÃ³d', 'Taras', 'Do remontu',
    'Do wykoÅ„czenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wtÃ³rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'])
</code></pre>                </div>
              </div>
            </div>
          </div>


          <br>
          <div class="wiz_uwagi">
            <h6 id="uwagi-header">Uwagi dotyczÄ…ce korelacji</h6>
            <li>Wykres korelacji reprezentuje zaleÅ¼noÅ›ci wartoÅ›ci miÄ™dzy atrybutami. JeÅ¼eli wartoÅ›Ä‡ jest pozytywna, oznacza to Å¼e wraz ze wzrostem wartoÅ›ci w danej kolumnie, wartoÅ›Ä‡ w danym wierszu rÃ³wnieÅ¼ wzroÅ›nie, jeÅ¼eli bÄ™dzie ujemna, zmaleje. WartoÅ›ci korelacji bliÅ¼ej 0 oznaczajÄ…, Å¼e  atrybut ma maÅ‚e znaczenie. 
            </li>
            <li>Pierwszym wartym zaznaczenia wnioskiem jest fakt, Å¼e atrybuty odlegÅ‚oÅ›ci do centrum i najbliÅ¼szej stacji metra majÄ… niemaÅ‚e znaczenie - sÄ… to jedne z wiÄ™kszych wynikÃ³w (-0,24 i -0,2) po najwyÅ¼ej korelujÄ…cymi z cenÄ… powierzchniÄ… i liczbÄ… pokoi. 
            </li>
            <li>Innymi znaczÄ…cymi atrybutami sÄ… rodzaje zabudowy, w szczegÃ³lnoÅ›ci blok (cena maleje) i apartamentowiec (cena roÅ›nie). Znaczna wiÄ™kszoÅ›Ä‡ najdroÅ¼szych mieszkaÅ„ byÅ‚a apartamentowcami.
            </li>
            <li>Dom okazaÅ‚ siÄ™ nieistotny, trzeba rÃ³wnieÅ¼ zaznaczyÄ‡, Å¼e iloÅ›Ä‡ ofert domÃ³w (tu poÅ‚Ä…czono domy wolnostojÄ…ce i szeregowce) byÅ‚a nieduÅ¼a. MoÅ¼liwe, Å¼e uwzglÄ™dnienie terenÃ³w takich jak podmiejskie rejony Piaseczna z wieloma osiedlami domÃ³w jednorodzinnych daÅ‚yby bardziej interesujÄ…ce wyniki. 
            </li>
            <li>Co prawda jest zauwaÅ¼alna bardzo duÅ¼a korelacja miÄ™dzy rokiem budowy a kamienicÄ…, moÅ¼na przypuszczaÄ‡ Å¼e powinna byÄ‡ jeszcze wiÄ™ksza. WÅ›rÃ³d ofert znajdowaÅ‚o siÄ™ kilka kamienic, gdzie za rok budowy najprawdopodobniej podano rok generalnego remontu.
            </li>
            <li>InteresujÄ…ca jest rÃ³wnieÅ¼ bliska zeru korelacja miÄ™dzy tarasem a domem. Taras ma rÃ³wnieÅ¼ doÅ›Ä‡ wysokÄ… korelacjÄ™ z cenÄ…, powierzchniÄ… i apartamentowcem, wiÄ™c moÅ¼liwe jest Å¼e dotyczÄ… one np. rozlegÅ‚ych tarasÃ³w na dachach budynkÃ³w.
            </li>
            <li>Stan mieszkania okazaÅ‚ siÄ™ rÃ³wnieÅ¼ doÅ›Ä‡ nieznaczny w stosunku do ceny, niemniej rozkÅ‚ad korelacji - negatywny dla stanu do remontu i do wykoÅ„czenia i pozytywny dla stanu do zamieszkania jest logiczny.
            </li>
          </div>
          
          <br> <br>
          Na koÅ„cu wykonano prosty Dashboard w programie Power BI. 
          DziÄ™ki zastosowaniu etykietek, po przefiltrowaniu np. mieszkaÅ„ w odlegÅ‚oÅ›ci do 1,5 km od stacji metra, moÅ¼na wyeksportowaÄ‡ tabelÄ™ z linkami do takich ofert.
          <br>

          <div class="center"; style="height: 364px; width: 644px; border:solid; border-color: black; border-width: 2px;">
            <div style="position:relative;width:fit-content;height:fit-content;">
              <a style="position:absolute;top:20px;right:1rem;opacity:0.8;" href="https://clipchamp.com/watch/brMlZsUl7Ua?utm_source=embed&utm_medium=embed&utm_campaign=watch">
                  <img loading="lazy" style="height:22px;" src="https://clipchamp.com/e.svg" alt="Made with Clipchamp" />
              </a>
              <iframe allow="autoplay;" allowfullscreen style="border:none" src="https://clipchamp.com/watch/brMlZsUl7Ua/embed" width="640" height="360"></iframe>
          </div>
        </div>


          </div>

          <div class="tresc modelowanie">
            <h4 id="modelowanie-header">Modelowanie</h4>
            Po oczyszczeniu danych pozostaÅ‚o tylko dobranie danych dla wytrenowania modelu.
            Modelowanie przeprowadzono przy pomocy prostej regresji liniowej z biblioteki scikit-learn oraz sieci neuronowej TensorFlow. 
            <br><br>
            Regresja liniowa polega na znalezieniu zaleÅ¼noÅ›ci miÄ™dzy wartoÅ›ciÄ… przewidywanÄ… (zmienna objaÅ›niana)
            a predyktorami (zmienne objaÅ›niajÄ…ce) poprzez dopasowanie wag predyktorÃ³w. 
            RÃ³wnanie regresji liniowej przedstawia siÄ™ nastÄ™pujÄ…co:

            $$y = Î²_0 + Î²_1 x_1 + Î²_2 x_2 + \dots + Î²_n x_n + \epsilon$$

            gdzie: 
            <li>\(y\) to zmienna objaÅ›niana, zaleÅ¼na, to co model przewiduje</li>
            <li>\(x_i\) to zmienna objaÅ›niajÄ…ca, niezaleÅ¼na, inaczej predyktor</li>
            <li>\(Î²_i\) to wspÃ³Å‚czynnik kierunkowy regresji, element ktÃ³ry dobiera model podczas trenowania </li>
            <li>\(\epsilon\) to nieskracalny bÅ‚Ä…d modelu</li>            
 
            <br>
            Z kolei sieÄ‡ neuronowa naÅ›laduje dziaÅ‚anie ludzkiego mÃ³zgu - jest zbudowana z wielu poziomÃ³w neuronÃ³w przetwarzajÄ…cych dane. 
            KaÅ¼dy pojedynczy neuron w danym poziomie jest poÅ‚Ä…czony ze wszystkimi neuronami w sÄ…siadujÄ…cych poziomach. 
            Proces modelowania przy pomocy sieci neuronowej zaczyna siÄ™ wprowadzaniem danych w warstwie wejÅ›ciowej,
            nastÄ™pnie nastÄ™puje propagacja w przÃ³d, dane sÄ… przekazywane kolejnym neuronom w kolejnych warstwach, wraz dobraniem wagi dla danego parametru.
            Neurony sÄ… aktywowane na podstawie funkcji aktywacyjnej, w tym projekcie wykorzystano ReLU (Rectified Linear Unit) ze wzglÄ™du na jej proste i szybkie dziaÅ‚anie.
            Po propagacji w przÃ³d nastÄ™puje propagacja wsteczna, podczas ktÃ³rej aktualizowane sÄ… wagi i bias (obciÄ…Å¼enie) idÄ…c od warstwy koÅ„cowej do wejÅ›ciowej.
            Sieci neuronowe majÄ… zastosowanie w wielu zagadnieniach w nauczaniu maszynowym, zaczynajÄ…c od regresji, a koÅ„czÄ…c na Chatbotach.
            <br>
            <img src="css\p1_images\wÅ‚asna sieÄ‡.png" style="width: 98%; max-height: 300px; margin: auto; object-fit: contain; padding: 15px;" alt="">
            <br><br>
            
            Przed modelowaniem usuniÄ™to kolumny 'pierwotny' (rynek) i 'do zamieszkania', 
            poniewaÅ¼ nie sÄ… one juÅ¼ potrzebne - 0 w kolumnie 'do wykoÅ„czenia' i 0 w kolumnie 'do remontu' wystarczÄ…. 
            Przy skorzystaniu z funkcji get_dummies moÅ¼na skorzystaÄ‡ z drop_first=True by osiÄ…gnÄ…Ä‡ ten efekt. 
            Tu zostaÅ‚o to zrobione dopiero na tym etapie w celu jaÅ›niejszej wizualizacji korelacji. 
            <br><br>
            We wszystkich modelach test_size w Train-Test-Split ustawiono na 0.3 co oznacza, Å¼e 70% danych zostaÅ‚o przeznaczone na wytrenowanie modelu, 
            a 30% na sprawdzenie. 
            <div style="height: 5px;"></div>
            Przy modelowaniu sieciÄ… neuronowÄ… wykorzystano narzÄ™dzie MinMaxScaler, 
            ktÃ³re normalizuje wartoÅ›ci na podstawie ich odchylenia standardowego oraz najmniejszej i najwiÄ™kszej wartoÅ›ci,
            tak aby byÅ‚y w przedziale od 0 do 1. DziÄ™ki temu bÅ‚Ä™dy wynikajÄ…ce z rÃ³Å¼nic w wielkoÅ›ciach wartoÅ›ci (np. powierzchnia mieszkania a dystans do centrum) 
            oraz ich wag i obciÄ…Å¼eÅ„ zostanÄ… zminimalizowane.
            <div style="height: 5px;"></div>
            Podczas modelowania nadano rÃ³wnieÅ¼ Dropout=0.2 przy kaÅ¼dej warstwie neuronowej. 
            Dropout powoduje losowe wyÅ‚Ä…czenie czÄ™Å›ci neuronÃ³w w warstwie, dziÄ™ki czemu model jest mniej podatny na overfitting - 
            zbyt dokÅ‚adne dopasowanie modelu pod treningowy zestaw danych, przez co stanie siÄ™ on mniej uniwersalny.
            Wykorzystano teÅ¼ EarlyStopping - narzÄ™dzie ktÃ³re zatrzymuje trening modelu w momencie gdy podany parametr przestanie siÄ™ poprawiaÄ‡, tu validation loss.
            NarzÄ™dzie okazaÅ‚o siÄ™ zbÄ™dne - przy iloÅ›ci epok (iteracji przez treningowy zbiÃ³r danych) modelu ustawionej na 800 model nie zostaÅ‚ zatrzymany. 
            IloÅ›ci epok nie zwiÄ™kszono ze wzglÄ™du na minimalne rÃ³Å¼nice bÅ‚Ä™dÃ³w miÄ™dzy 800 a 1600 epokami.

            <br><br>
            Do ewaluacji modelu wykorzystano:
            <li>MAE - Mean Absolute Error - Å›redni bÅ‚Ä…d bezwzglÄ™dny</li>
            <li>RMSE - Root Mean Squared Error - pierwiastek bÅ‚Ä™du Å›redniokwadratowego - bardziej wyczulony na duÅ¼e bÅ‚Ä™dy, 
            moÅ¼na go Å‚atwo interpretowaÄ‡ dziÄ™ki pierwiastkowi (bez pierwiastka znany jako MSE)</li>
            <li>RÂ² - wspÃ³Å‚czynnik determinacji - osiÄ…ga wartoÅ›ci od 0 do 1, wyÅ¼sza wartoÅ›Ä‡ oznacza lepiej dopasowanÄ… liniÄ™ regresji</li>
            <br>

            $$MAE=\frac{1}{n}\sum^n_{i=1}|y_i-\hat{y_i}|$$	
            <!-- MAE - Å›redni bÅ‚Ä…d bezwzglÄ™dny - Å›rednia z sumy wartoÅ›ci bezwzglÄ™dnych bÅ‚Ä™dÃ³w -->
            $$RSME=\sqrt{\frac{1}{n}\sum^n_{i=1}(y_i-\hat{y_i})^2}$$
            $$R^2=1-\frac{\sum^n_{i=1}(y_i-\hat{y_i})^2}{\sum^n_{i=1}(y_i-\overline{y_i})^2}$$
            gdzie: 
            <li>\(\sum(y_i-\hat{y_i})^2\) to suma kwadratÃ³w pozostaÅ‚oÅ›ci, tzw. residuals, potÄ™ga rÃ³Å¼nicy miÄ™dzy wartoÅ›ciÄ… prawdziwÄ… a wartoÅ›ciÄ… przewidywanÄ…</li>
            <li>\(\sum(y_i-\overline{y_i})^2\) to suma kwadratÃ³w ogÃ³Å‚em, potÄ™ga rÃ³Å¼nicy miÄ™dzy prawdziwÄ… wartoÅ›ciÄ… a Å›redniÄ… tego rodzaju wartoÅ›ci</li>
            <!-- RMSE - pierwiastek bÅ‚Ä™du Å›redniokwadratowego - bardziej wyczulony na duÅ¼e bÅ‚Ä™dy, moÅ¼na go Å‚atwo interpretowaÄ‡ dziÄ™ki pierwiastkowi (bez pierwiastka znany jako MSE) -->
            <br>
            MAE, MSE i RMSE sÄ… wartoÅ›ciami, ktÃ³re chcemy zminimalizowaÄ‡ podczas budowania modelu. 
            
            Na wykresach rozrzutu zaznaczono rÃ³wnieÅ¼ liniÄ™ wzdÅ‚uÅ¼ ktÃ³rej przebiegaÅ‚aby idealna koncentracja przewidywanych punktÃ³w. 
            Punkt znajdujÄ…cy siÄ™ bliÅ¼ej tej linii bÄ™dzie oznaczaÅ‚ mniejszy bÅ‚Ä…d. 
            Gdyby model opieraÅ‚ siÄ™ tylko na jednej wartoÅ›ci (np. powierzchni mieszkania) czyli nie byÅ‚ modelem regresji wielokrotnej, 
            moÅ¼liwe byÅ‚oby wyprowadzenie faktycznej linii funkcji regresji liniowej. 
            
            Na wykresach po prawej przedstawiono dystrybucjÄ™ wartoÅ›ci residuals, 
            im wiÄ™cej wartoÅ›ci bliÅ¼ej 0, tym lepiej.

            <br><br>Modelowanie przeprowadzono dla kilku rÃ³Å¼nych przedziaÅ‚Ã³w. 
            Na potrzeby tego sprawozdania przedstawiono wyniki dla dwÃ³ch przedziaÅ‚Ã³w. 
             - najpierw usuniÄ™to mieszkania powyÅ¼ej 9 000 000 zÅ‚. 
            Wyniki przedstawiono poniÅ¼ej. 
            <br><br>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 9 mln zÅ‚</h5>
                    <li>MAE: 251 527 [zÅ‚]</li>
                    <li>RMSE: 393 270 [zÅ‚]</li>
                    <li>RÂ²: 0.80</li>     
                  </div>
                </div>
              </div>
            </div>

            <div style="height: 5px;"></div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 9 mln zÅ‚</h5>
                    <li>MAE: 697 458 [zÅ‚]</li>
                    <li>RMSE: 1 106 752 [zÅ‚]</li>
                    <li>RÂ²: 0.75</li>                    
                  </div>
                </div>
              </div>
            </div>
            <br>
            Mimo wysokiego wyniku RÂ² i EV taki model nie jest zbyt praktyczny - Å›rednie bÅ‚Ä™dy sÄ… zbyt wysokie, w szczegÃ³lnoÅ›ci 
            w przypadku RMSE dla sieci neuronowej TensorFlow gdzie RMSE wynosi ponad 1 mln zÅ‚, czyli trochÄ™ wiÄ™cej niÅ¼ Å›rednia cena mieszkania w zestawie danych. 
            Jest tu teÅ¼ wyraÅºnie widoczny efekt badania RMSE, ktÃ³ry jest bardziej 'wyczulony' na wartoÅ›ci mocno odbiegajÄ…ce od wartoÅ›ci Å›rednich. 
            Dlatego w kolejnym podejÅ›ciu przedziaÅ‚ danych ograniczono do cen od 125 000 do 2 500 000 mln zÅ‚. <br><br>
             
            
            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 2,5 mln zÅ‚</h5>
                    <li>MAE: 147 788 [zÅ‚]</li>
                    <li>RMSE: 211 835 [zÅ‚]</li>
                    <li>RÂ²: 0.75</li>     
                  </div>
                </div>
              </div>
            </div>

            <div style="height: 5px;"></div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 2,5 mln zÅ‚</h5>
                    <li>MAE: 412 673 [zÅ‚]</li>
                    <li>RMSE: 557 260 [zÅ‚]</li>
                    <li>RÂ²: 0.74</li>                    
                  </div>
                </div>
              </div>
            </div>

            <br><br>
            PoniÅ¼ej przedstawiono ceny trzech mieszkaÅ„ przewidziane przez modele. 
            Dane mieszkaÅ„ zostaÅ‚y wprowadzone w formie Pythonowego dictionary, a nastÄ™pnie utworzono z nich jednowierszowÄ… tabelÄ™ Pandas.
            W przypadku przewidywania cen mieszkaÅ„ przez TensorFlow rÃ³wnieÅ¼ naleÅ¼aÅ‚o uÅ¼yÄ‡ narzÄ™dzia MinMaxScaler.
            <br><br>

            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Mieszkanie</th>
                  <th scope="col">LR <9 mln zÅ‚</th>
                  <th scope="col">TF <9 mln zÅ‚</th>
                  <th scope="col">LR <2,5 mln zÅ‚</th>
                  <th scope="col">TF <2,5 mln zÅ‚</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">37 mÂ², blok, WÅ‚ochy</th>
                  <td>365 607 zÅ‚</td>
                  <td>516 649 zÅ‚</td>
                  <td>494 160 zÅ‚</td>
                  <td>531 320 zÅ‚</td>
                </tr>
                <tr>
                  <th scope="row">54 mÂ², apartament, Kabaty</th>
                  <td>394 026 zÅ‚</td>
                  <td>628 492 zÅ‚</td>
                  <td>577 780 zÅ‚</td>
                  <td>667 709 zÅ‚</td>
                </tr>
                <tr>
                  <th scope="row">96 mÂ², apartament, Natolin</th>
                  <td>1 501 197 zÅ‚</td>
                  <td>1 358 248 zÅ‚</td>
                  <td>1 397 107 zÅ‚</td>
                  <td>1 519 427 zÅ‚</td>

                </tr>
              </tbody>
            </table>
            <br>
            <h4 id="wnioski-header">7. Wnioski</h4>
            <h6>
              Na podstawie wynikÃ³w z tabeli oraz interpretacji wykresÃ³w i bÅ‚Ä™dÃ³w wyciÄ…gniÄ™to nastÄ™pujÄ…ce wnioski:
            </h6>
            <li>Model regresji liniowej mocno zaniÅ¼a wartoÅ›ci mieszkaÅ„ w najniÅ¼szym przedziale cen - do ok. 500 tys. zÅ‚.</li>
            <li>Natomiast w przedziale od ok. 0,5 do 1 mln zÅ‚ ceny sÄ… lekko zawyÅ¼one.</li>
            <li>Ceny mieszkaÅ„ powyÅ¼ej 1,5 mln zÅ‚ rÃ³wnieÅ¼ sÄ… zaniÅ¼ane, im droÅ¼sze mieszkania tym rozrzut przewidywanych cen jest wiÄ™kszy,
              ze wzglÄ™du na mniejszÄ… iloÅ›Ä‡ takich ofert w zestawie danych do wytrenowanie celnego modelu.</li>
            <li>W przypadku sprawdzonych mieszkaÅ„ z tabeli, model TF<9 mln zÅ‚ okazaÅ‚ siÄ™ doÅ›Ä‡ trafny.
            Wysokie wartoÅ›ci MEA i RMSE najprawdopodobniej wynikajÄ… z ofert mieszkaÅ„ powyÅ¼ej 2 mln zÅ‚. 
            Niemniej do zbudowania modeli przydatnych do przewidywania cen tak drogich mieszkaÅ„, 
            niezbÄ™dna byÅ‚aby wiÄ™ksza iloÅ›Ä‡ drogich mieszkaÅ„ w zestawie danych.</li>
            <li>Cena mieszkania na Kabatach wydaje siÄ™ mocno zaniÅ¼ona we wszystkich przypadkach, 
            mimo niemaÅ‚ej powierzchni i Å›wietnej lokalizacji wzglÄ™dem stacji metra. 
            JednÄ… z przyczyn moÅ¼e byÄ‡ korelacja atrybutu 'apartament' z maÅ‚Ä… powierzchniÄ… lub innymi atrybutami - 
            wiele ofert bardzo maÅ‚ych mieszkaÅ„ zostaÅ‚o otagowanych przez deweloperÃ³w jako aparatamenty, 
            rÃ³wnieÅ¼ podczas oczyszczania danych wiele brakujÄ…cych danych w kolumnie 'zabudowa' mogÅ‚o zostaÄ‡ bÅ‚Ä™dnie przypisanych.</li>
          
            <br>
            <h6>Sugestie jak ulepszyÄ‡ modele:
            </h6>
            <li>Dodanie wiÄ™cej danych, np. z danych archiwalnych lub innych stron z ofertami mieszkÄ…Å„</li>
            <li>Zastosowanie lepszych metod podczas oczyszczania danych np. czÄ™Å›ciejsze uzupeÅ‚nienie przy pomocy BeautifulSoup</li>
            <li>Dodanie nowych atrybutÃ³w: w przypadku wiÄ™kszego i bardziej wyrÃ³wnanego  zestawu danych moÅ¼na by wykorzystaÄ‡
             one-hot encoding dla kolumny dzielnica - rÃ³Å¼nice korelacji miÄ™dzy cenÄ… a dzielnicÄ… byÅ‚yby interesujÄ…ce same w sobie i 
             byÄ‡ moÅ¼e poprawiÅ‚yby jakoÅ›Ä‡ modeli.
            Np. moÅ¼na by siÄ™ spodziewaÄ‡, Å¼e mieszkania w WesoÅ‚ej bÄ™dÄ… korelowaÄ‡ z niÅ¼szÄ… cenÄ… niÅ¼ mieszkania na Mokotowie.
            Niestety obecnie w zestawie danych jest niewiele  ofert z dzielnic takie jak WesoÅ‚a czy RemembertÃ³w, 
            co mogÅ‚oby spowodowaÄ‡ np. znaczÄ…ce zaniÅ¼enie przewidywanych ofert z tych dzielnic.
            </li>
            <li>
              Zastosowanie lepszych modeli i metod nauczania maszynowego, np. zastosowaÄ‡ walidacjÄ™ krzyÅ¼owÄ… lub regularyzacjÄ™.
            </li>
            <br>
            <h4 id="poprawki-header">8. LASSO, XGBoost, SHAP</h4>
            Do tego projektu postanowiÅ‚em wrÃ³ciÄ‡ ze Å›wieÅ¼o zdobytÄ… wiedzÄ… na temat regularyzacji, 
            bardziej zaawansowanych algorytmÃ³w nauczania maszynowego oraz metod analizy modeli. 
            <li>LASSO - metoda regularyzacji regresji liniowej, umoÅ¼liwajÄ…ca wyeliminowanie nieistotnych cech. Tu wykorzystana do wizualizacji znaczenia cech.</li>
            <li>XGBoostRegressor - model poprawiajÄ…cy siÄ™ poprzez uwzglÄ™dninie wynikÃ³w z kaÅ¼dej poprzedniej iteracji</li>
            <li>SHAP - narzÄ™dzie wyjaÅ›niajÄ…ce, jak model przewidziaÅ‚ szukanÄ… dla danej prÃ³bki</li>

            <br>
            <h5>LASSO</h5>
           LASSO - Least Absolute Shrinkage and Selection Operator to odmiana regresji liniowej, ktÃ³ra wykorzystuje regularyzacjÄ™ L1.
           <div style="height: 5px;"></div>

           Regularyzacja L1 polega na zmniejszeniu obciÄ…Å¼enia (bias) poprzez naÅ‚oÅ¼enie kary na wsp. kierunkowy wartoÅ›ciÄ… Î» (lambda). 
           DziÄ™ki niej moÅ¼na zmniejszyÄ‡ lub caÅ‚kowiecie â€wyÅ‚Ä…czyÄ‡â€ wagÄ™ nieistotnej cechy. 	
           WartoÅ›Ä‡ Î» moÅ¼na dobieraÄ‡ poprzez walidacjÄ™ krzyÅ¼owÄ…, technikÄ™ dziÄ™ki ktÃ³rej moÅ¼na znaleÅºÄ‡ najepsze hiperparametry modelu lub podziaÅ‚ zestawu danych na zestaw treningowy i testowy.
           Szuka siÄ™ minimalnej wartoÅ›ci funkcji straty z poniÅ¼szego wzoru:

           $$\underset{\gamma}{argmin} \; \sum^n_{i=1}(y_i - \hat{y_i})^2 + \lambda \sum^p_{j=1} |\hat\beta_j|$$

           gdzie: 
           <li>\((y_i-\hat{y_i})^2\) to residuals</li>
           <li>\(\lambda\) to hiperparametr regularyzacji, odpowiada za kurczenie siÄ™ (shrinkage) waÅ¼noÅ›ci cech </li>
           <li>\(\beta_i\) to wsp. kierunkowy regresji danej cechy</li>
           <div style="height: 15px;"></div>
           Lasso nie zostaÅ‚o tu wykorzystane do utworzenia modelu, ale do wskazania, ktÃ³re cechy zestawu danych sÄ… istotne oraz jakÄ… majÄ… wagÄ™.
           UÅ¼yto tu moetody lasso_paths i wykreÅ›lono zaleÅ¼noÅ›Ä‡ miÄ™dzy wartoÅ›ciÄ… Î» a wspÃ³Å‚czynnikami wagi cech. 
           Zestaw danych jest ten same, ograniczony do prÃ³bek o cenach od 125 000 do 2 500 000 zÅ‚.

           <div style="height: 15px;"></div>

           <img class="myImg" src="css\p1_images\Lasso paths.png"  style="width: 95%;">
           <div id="myModal" class="modal">
             <div class="opacity-background close">
               <span class="close">&times;</span>
             </div>
             <img class="modal-content" id="img01">
             <div id="caption"></div>
           </div>

           <div style="height: 15px;"></div>

           
           
           
           OÅ› X reprezentuje wzrost wartoÅ›ci Î», czyli karÄ™.
           OdlegÅ‚oÅ›Ä‡ od 0 na osi y wskazuje na istotnoÅ›Ä‡ cechy, a krzywe poniÅ¼ej 0 wskazujÄ…, Å¼e wzrost danej cechy obniÅ¼y przewidywanÄ… cenÄ™, nie Å¼e sÄ… mniej istotne.
           <br>
           Z wykresu moÅ¼na odczytaÄ‡, Å¼e cechy takie jak <span style="font-weight: 600;">powierzchnia mieszkania, dystans do ÅšwiÄ™tokrzyskiej i dystans do najbliÅ¼szej stacji metra oraz blok</span>
           sÄ… najistotniejszymi cechami z zestawu danych. OczywiÅ›cie powierzchnia jest zdecydowanie najwaÅ¼niejsza. Widoczne jest rÃ³wnieÅ¼ Å¼e cechy te najdÅ‚uÅ¼ej â€przetrwaÅ‚yâ€ wzrost Î», w przeciwieÅ„stwie do np. roku budowy.

           <br>
           <br>

           <h5>XGBoost</h5>
           XGBoost, a wÅ‚aÅ›ciwie eXtremeGradientBoostRegressor to jeden z najbardziej skutecznych i celnych algorytmÃ³w uczenia maszynowego stosowany do zagadnieÅ„ z regresji i klasyfikacji.
           Jest oparty na zespole drzew decyzyjnych, w ktÃ³rym kaÅ¼de drzewo jest doÅ›Ä‡ sÅ‚abym modelem przewidujÄ…cym, zwykle majÄ…cym od 3 do 5 poziomÃ³w gÅ‚Ä™bokoÅ›ci. 
           Z kaÅ¼dÄ… iteracjÄ… XGBoostRegressor buduje poprawki na podstawie poprzednich wynikÃ³w i bÅ‚Ä™dÃ³w. 
           W przypadku tu przeprowadzonego modelu, bÅ‚Ä™dy byÅ‚y liczone na podstawie funkcji straty z <span style="font-weight: 600;">SSR</span>, czyli <span style="font-weight: 600;">Sum of Squared Residuals</span> - \((y_i-\hat{y_i})^2\) 
          , a hiperparametry znalezione przy pomocy walidacji krzyÅ¼owej to iloÅ›Ä‡ drzew rÃ³wna 100 i gÅ‚Ä™bokoÅ›Ä‡ drzew rÃ³wna 5. Model osiÄ…gnÄ…Å‚ bardzo wysokÄ… celnoÅ›Ä‡ 84%:

           <div class="card mb-6" style="max-width: 900px; padding: 10px;">
            <div class="row g-0">
              <div class="col-md-8">
                <img src="css\p1_images\XGB scatter perfect.png" class="img-fluid rounded-start" alt="...">
              </div>
              <div class="col-md-4">
                <div class="card-body">
                  <h5 class="card-title">XGBoostRegressor<br> do 2.5 mln zÅ‚</h5>
                  <li>MAE: 115 486 [zÅ‚]</li>
                  <li>RMSE: 166 262 [zÅ‚]</li>
                  <li>RÂ²: 0.84</li>     
                </div>
              </div>
            </div>
          </div>

          <!-- <br>
          <img src="css\p1_images\XGB residuals.png" style="max-width: 98%;  margin: auto; object-fit: contain; padding: 15px;" alt="">
          <br><br> -->


          <div class="card mb-6" style="max-width: 900px; padding: 10px;">
            <div class="row g-0">
              <div class="col-md-12">
                <img src="css\p1_images\XGB residuals.png" class="img-fluid rounded-start" alt="...">
              </div>

            </div>
          </div>

          </div>

        </div>
      </span>
        <div class="col-md-3" style="padding-left: 36px;"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#top">1. WstÄ™p</a> <br>
            <a href="#zebranie_danych-header">2. Zebranie danych</a> <br>
            <a href="#QGIS-header">3. Mapa i przetworzenie danych w QGIS</a> <br>
            <a href="#pandas-header">4. Oczyszczenie danych w Pandas</a> <br>
            <a href="#wizualizacja-header">5. Wizualizacja danych</a> <br>
            <a href="#uwagi-header" style="margin-left:15px">Uwagi dotyczÄ…ce korelacji</a> <br>
            <a href="#modelowanie-header">6. Modelowanie</a> <br>
            <a href="#wnioski-header">7. Wnioski</a> <br>
            <a href="#poprawki-header">8. LASSO, XGBoost, SHAP</a>

            <hr style="width: 200px; margin-top: 26px; margin-bottom: 20px">

            <a href="#top">PowrÃ³t do poczÄ…tku</a> <br>
          </div>
        </div>
    </div>
      
    <section class="jumbotron text-center">
      <div class="container", style="padding-top: 90px;">
        <p>
          <a href="#top" class="btn btn-outline-secondary my-2 botbuttons" >PowrÃ³t do poczÄ…tku</a>
          <a href="index.html"class="btn btn-secondary my-2 botbuttons" >PowrÃ³t do strony gÅ‚Ã³wnej</a>
        </p>
      </div>
  </section>

    <div id="footer", class="bottom", style="font-size:0.77em;">      
          <p style="margin:5px;">&copy; <script>document.write(new Date().getFullYear());</script> Konrad Jarominiak</p>
          <p>Wykorzystano:
            <a href="https://getbootstrap.com/" class="footer-link">Bootsrap 5</a>,
            <a href="https://highlightjs.org/" class="footer-link">highlight.js</a>,
            <a href="https://www.mathjax.org/" class="footer-link">MathJax</a> </p>
        </div>

    <script>hljs.highlightAll();</script>
    <script src="scripts\modal.js"></script>
  </body>
</html>