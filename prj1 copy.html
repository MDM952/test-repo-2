<!DOCTYPE html>
<html lang="en" dir="ltr">

    <head>
        <meta charset="utf-8">
        <title>Portfolio ğŸ’</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="css/css_project_page.css">
        <link rel="stylesheet" href="css/cssmaster.css">
        <link rel="icon" href="C:\Users\konra\Documents\WÅ‚asne\Programowanie\HTML CSS Javascript Course\Web Developement 15\6 - Bootstrap Tindog\css\favicon.ico">
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/1c9ad4b785.js" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="scripts\code highlight\styles\idea.min.css"/>
        <script src="scripts\code highlight\highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>

      </head>
  <body>
      
    <section class="jumbotron text-center">
        <div class="container">
          <h1>Konrad Jarominiak - porftolio</h1>
          <p class="lead text-muted">
            Oto kilka projektÃ³w z dziedzin data science, danych przestrzennych i wizualizacji danych.
          </p>
          <p>
            <a
              href="https://getbootstrap.com/docs/4.4/examples/album/#"
              class="btn btn-primary my-2"
              >Main call to action</a
            >
            <a
              href="https://getbootstrap.com/docs/4.4/examples/album/#"
              class="btn btn-secondary my-2"
              >Secondary action</a
            >
          </p>
        </div>
    </section>

    <span class="border border-0">

    <div class="container">
      <div class="row">
        <div class="col-md-8">

          <div class="tresc wstep">
            <h4 id="wstep-header">1. WstÄ™p</h4>
            Niniejszy projekt data science miaÅ‚ na celu przedstawienie prostego sposobu na wykorzystanie danych przestrzennych w modelowaniu data science.
            W projekcie sprawdzono jak duÅ¼e znaczenie odgrywa odlegÅ‚oÅ›Ä‡ mieszkania do centrum miasta i 
            odlegÅ‚oÅ›ci mieszkania do najbliÅ¼szej stacji metra na rynku mieszkaniowym w Warszawie. 
            W projekcie wykorzystano:
<li>Selenium i Beautiful Soup w celu zebrania danych</li>
<li>SQLAlchemy do przechowania danych w bazie danych</li>
<li>GIS do wyznaczenia odlegÅ‚oÅ›ci oraz przedstawienia mieszkaÅ„ z zebranych ofert na mapie Warszawy</li>
<li>Pandas do przetworzenia i oczyszczenia danych</li>
<li>Matplotlib i Seaborn do wizualizacji danych</li>
<li>sci-kit learn i Keras do stworzenia modelu</li>

          </div>

          <div class="tresc zebranie_danych">
            <h4 id="zebranie_danych-header">2. Zebranie danych</h4>

            Do zebrania danych wstÄ™pnych danych wykorzystano Selenium webdriver, czyli narzÄ™dzie umoÅ¼lwiajÄ…ce zautomatyzowanie funkcjonalnoÅ›ci przeglÄ…darki. 
            WstÄ™pne dane (indeksy, linki i powiat) zebrano z pewnej strony z ofertami mieszkaÅ„ z wynikami dla Warszawy. 
            Wykorzystano tu Selenium ze wzglÄ™du na fakt, Å¼e oferty Å‚adowane sÄ… wraz z przewijaniem strony przez uÅ¼ytkownika â€“ Beautiful Soup nie wyÅ‚apaÅ‚oby Å¼adnych ofert.
            Dane przechowano przy pomocy SQLAlchemy:
            <pre><code> <!-- Kod bazy danych -->
class Links(Base):  
    __tablename__ = "Links"  
    numer = Column("numer", Integer, primary_key=True)  
    powiat = Column("powiat", String)  
    link = Column("link", String)  

    def __init__(self, numer, powiat, link):  
        self.numer = numer  
        self.link = link  
        self.powiat = powiat  

    def __repr__(self):  
        return f"({self.numer}, {self.powiat}, {self.link})"
            </code></pre>
            W sumie uzyskano 3600 linkÃ³w z czego czÄ™Å›Ä‡ zawieraÅ‚a linki do ofert po za WarszawÄ…. 
            Na potrzeby stworzenia mapy w QGIS nie przefiltrowano wynikÃ³w tylko do Warszawy.
            <br>
            Do zebrania szczegÃ³Å‚owych danych rÃ³wnieÅ¼ zastosowano Selenium. 
            Web scraping przy pomocy Beautiful Soup byÅ‚by szybszy i o wiele prostszy, ale nie umoÅ¼liwiÅ‚by zebrania wspÃ³Å‚rzÄ™dnych z zaembedowanej mapy google. 
            Bez przewijania strony, poniÅ¼sza mapa nie byÅ‚aby widoczna i moÅ¼liwa do zescrapowania.
            <img src="css\p1_images\embed mapy googli.png" style="margin: 10px auto 10px; width: 100%;">
            <br>
            Zbierania wspÃ³Å‚rzÄ™dnych dokonywano przy pomocy poniÅ¼szego kodu:
            <pre><code> <!-- Kod dla zbierania LATT LONG-->
try:  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )  
except NoSuchElementException:  
    driver.refresh()  
    driver.execute_script("arguments[0].scrollIntoView();",  
                          driver.find_element(By.ID, 'map')  
                          )
# ...
map_link = driver.find_element(By.XPATH, "//a[contains(@href,'apiv3')]")  
coord = map_link.get_attribute('href').split('ll=')[1].split('&')[0].split(',')  
coord_dict = {  
    'lat': float(coord[0]),  
    'long': float(coord[1])  
    }  
            </code></pre>
            PozostaÅ‚e dane zbierane byÅ‚y gÅ‚Ã³wnie w nastÄ™pujÄ…cy sposÃ³b: dla kaÅ¼dego elementu z listy `all_topics` zbierano wartoÅ›Ä‡ z tabeli szczegÃ³Å‚Ã³w na stronie. 
            W przykÅ‚adzie dla gÅ‚Ã³wnych informacji nie zdarzaÅ‚o siÄ™ aby funkcja separujÄ…ca dane z tekstu zwracaÅ‚a wartoÅ›Ä‡ `None`, zamiast tego zwracaÅ‚a 'Zapytaj' 
            gdy danych nie doprecyzowano. W sekcji oczyszczania danych te dane zostaÅ‚y poprawione i zastÄ…pione. 
            <br>
            <pre><code> <!-- Kod dla zbierania danych gÅ‚Ã³wnych -->
def separate_value(text, topic):  
    try:  
        value = text.find_element(By.CSS_SELECTOR, f'div[aria-label="{topic}"]')  
        value = value.text.split(topic)[1].replace('\n', '')  
        return value  
    except NoSuchElementException:  
        return None  
  
  
all_topics = ["Powierzchnia", "Liczba pokoi", "PiÄ™tro", "Powierzchnia dziaÅ‚ki", "Czynsz", "Forma wÅ‚asnoÅ›ci", "Stan wykoÅ„czenia",  
                    "Balkon / ogrÃ³d / taras", "Miejsce parkingowe", "Ogrzewanie"]  
  
try:  
    main_info_dict = driver.find_element(By.CSS_SELECTOR, 'div[data-testid="ad.top-information.table"]')  
except NoSuchElementException:  
    driver.refresh()  
    collect_info(link, numer)  
    return  
  
main_dict = {}  
for topic in all_topics:  
    main_dict[topic] = separate_value(main_info_dict, topic)
            </code></pre>
            WÅ›rÃ³d wszystkich ofert znalazÅ‚a siÄ™ niemaÅ‚a iloÅ›Ä‡ ofert deweloperÃ³w, wÅ›rÃ³d ktÃ³rych nie zostaÅ‚y podane Å¼adne dane z informacji dodatkowych, 
            np. rynek wtÃ³rny/pierwotny, winda czy rodzaj zabudowy. Te dane rÃ³wnieÅ¼ uzupeÅ‚niono w sekcji oczyszczania danych.

            Zapisanie danych ofert dokonano w ten sam sposÃ³b co przy zbieraniu samych ofert i daÅ‚o poniÅ¼szÄ… tabelÄ™, wyÅ›wietlanÄ… w SQLLiteStudio:
            <br><br>
            <img src="css\p1_images\SQL dane szczegÃ³Å‚owe.png" style="width: 98%;">
          </div>

          <div class="tresc przetworzenie_w_QGIS">
            <h4 id="QGIS-header">3. Przetworzenie danych w QGIS</h4>
            TabelÄ™ zawierajÄ…cÄ… szczegÃ³Å‚owe dane zaÅ‚adowano do programu QGIS wraz warstwÄ… dzielnic Warszawy oraz stacji metra. 
            Do wyznaczenia odlegÅ‚oÅ›ci wykorzystano dwa narzÄ™dzia wektorowe: 
            <li>
            liniowa odlegÅ‚oÅ›Ä‡ do najbliÅ¼szego huba, do obliczenia odlegÅ‚oÅ›ci do centrum Warszawy 
            (na potrzeby tego projektu uznano stacjÄ™ ÅšwiÄ™tokrzyskÄ… za centrum)
            </li>
            <li>
            macierz odlegÅ‚oÅ›ci do obliczenia odlegÅ‚oÅ›ci do najbliÅ¼szej stacji metra, 
            tu obliczono odlegÅ‚oÅ›ci do najbliÅ¼szych piÄ™ciu, a nastÄ™pnie przefiltrowano tabelÄ™
            </li>
            Efektem przetworzenia danych w QGIS jest mapa mieszkaÅ„ oraz dwie nowe kolumny z odlegÅ‚oÅ›ciami, ktÃ³re zostaÅ‚y wykorzystane w modelowaniu. 
            Kilka mieszkaÅ„ w okolicach Ursynowa nie zostaÅ‚o poprawnie przefiltrowanych, niemniej nie powinny mieÄ‡ one znaczenia, ze wzglÄ™du na ich nieduÅ¼Ä… odlegÅ‚oÅ›Ä‡ od stacji metra.
          
            <br><br>
            <img src="css\p1_images\Warszawa.png" style="width: 95%;" alt="">
          </div>

          <div class="tresc oczyszczenie_danych">
            <h4 id="pandas-header">4. Oczyszczenie danych w Pandas</h4>
            WstÄ™pne sprawdzenie rodzaju danych w tabeli przedstawia siÄ™ nastÄ™pujÄ…co:
            <pre><code class="language-python"> <!-- kod typy danych -->
              numer int64 
              link object 
              Cena int64 
              powierzchnia object 
              powierzchnia_dzialki float64 
              lokalizacja object 
              n_pokojow int64 pietro object 
              czynsz object 
              wlasnosc object 
              wykonczenie object 
              zewnatrz object # taras, ogrÃ³d, balkon
              parking object 
              ogrzewanie object 
              rynek object 
              ogloszenie object 
              rok_budowy object 
              zabudowa object 
              winda object 
              latt float64 
              long float64 
              Dystans do Swietokrzyskiej float64 
              najblizsza stacja object 
              dystans do najblizszej stacji [m] float64
              dtype: object
            </code></pre>

            Oczyszczenie danych polegaÅ‚o na:
            <ol>
              <li>
                Zamianie wartoÅ›ci na dane liczbowe, w przypadku kolumn takich jak cena czy powierzchnia wymagaÅ‚o usuniÄ™cia elementÃ³w z teksu takich jak mÂ², 
                zamianie przecinkÃ³w na kropki i ogÃ³lnÄ… zmianÄ™ typu danych na int i float
              </li>
              <li>
                Zamianie pÃ³l z 'Zapytaj' i NaN czyli niereprezentowalnych brakujÄ…cych wartoÅ›ci na 
                takie ktÃ³re miaÅ‚y sens w kontekÅ›cie tabeli i danego wiersza np.:
                <pre><code class="language-python"> <!-- kod blok a winda -->
blok_a_winda = {0:None, 1:'blok'}
df['zabudowa'] = df['zabudowa'].fillna(df['winda'].map(blok_a_winda))
                </code></pre>
                Innym przykÅ‚adem uzupeÅ‚nienia danych jest wykorzystanie Beautiful Soup. 
                Przy pomocy tego scrapera sprawdzono, czy opis oferty zawiera wyraÅ¼enia takie jak 'wymaga remontu' i uzupeÅ‚niono kolumny.
                <pre><code class="language-python"> <!-- kod BS4 i remont -->
def parse_remont(link):
    response = requests.get(link, headers=HEADERS)
    soup = BeautifulSoup(response.content, 'html.parser')
    
    try:
        opis = soup.find('div',{'data-cy':'adPageAdDescription'}).text
        ad_title = soup.find('h1',{'data-cy':'adPageAdTitle'}).text
    except AttributeError: # przypadki gdy oferta zostaÅ‚a usuniÄ™ta
        return
        
    lista_remont = ['do remontu', 'wymaga remontu', 'wymagajÄ…ce remontu', 'wymagajÄ…cy remontu', 
                    'czÄ™Å›ciowego remontu', 'generalnego remontu', 
                    'caÅ‚kowitego remontu', 'do odnowy', 'do odnowienia', ]

    for r in lista_remont:
        if r in ad_title or r in opis:
            return 'do remontu'
        else:
            return 'do zamieszkania'
            
df.loc[df['wykonczenie'] == 'Zapytaj', 'wykonczenie'] 
= df.loc[df['wykonczenie'] == 'Zapytaj', 'link'].apply(lambda x: parse_remont(x))
                </code></pre>
              </li>
              <li>
                UsuniÄ™to zbÄ™dne kolumny i kolumny ze zbyt duÅ¼Ä… iloÅ›ciÄ… brakujÄ…cych danych, np. 'wÅ‚asnoÅ›Ä‡' czy 'ogÅ‚oszenie'
              </li>
              <li>
                Zastosowano OneHotEncoding przy pomocy pandas.get_dummies - z kolumny 'zabudowa' utworzono cztery nowe kolumny: 'apartamentowiec', 'blok', 'dom', 'kamienica'. JeÅ¼eli dane mieszkanie znajduje siÄ™ w bloku, w kolumnie 'blok' bÄ™dzie wartoÅ›Ä‡ 1, w pozostaÅ‚ych 0.
                <br>
                W przypadku kolumny 'zewnÄ…trz' zastosowano wÅ‚asne funkcje do uzupeÅ‚nienia kolumn, ze wzglÄ™du na fakt, Å¼e w jednym mieszkaniu mogÄ… wystÄ™powaÄ‡ kilka opcji np. balkon i taras jednoczeÅ›nie:
                <pre><code class="language-python"> <!-- kod dummies dla zewnÄ…trz1 -->
def get_balkon(text):
    if 'balkon' in text:
        return 1
    else:
        return 0

def get_ogrod(text):
    if 'ogrÃ³dek' in text:
        return 1
    else:
        return 0

def get_taras(text):
    if 'taras' in text:
        return 1
    else:
        return 0

df["balkon"] = df["zewnatrz"].apply(lambda x: get_balkon(x))
df["ogrod"] = df["zewnatrz"].apply(lambda x: get_ogrod(x))
df["taras"] = df["zewnatrz"].apply(lambda x: get_taras(x))
                </code></pre>                
              </li>

            </ol>



          </div>

          <div class="tresc AKORDEONY"> <!-- PoczÄ…tek wizualizacji i akordeonu -->
            <h4 id="wizualizacja-header">5. Wizualizacja danych</h4>
          <div class="accordion" id="accordionPanelsStayOpenExample"> 
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                  <img src="css\p1_images\Histogram cen.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6),)
ax.set_ylabel("CzÄ™stoÅ›Ä‡")
sns.histplot(df['Cena'], color='olivedrab').set_title('Histogram cen')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
                  <img src="css\p1_images\PudeÅ‚kowy cen dzielnice.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-66)
chart  = sns.boxplot(data=df, y='Cena', x='lokalizacja', 
    order=df.groupby('lokalizacja').mean()['Cena'].sort_values(ascending=True).index.tolist(),)
    
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pudeÅ‚kowy cen w zaleÅ¼noÅ›ci od dzielnicy')
                                                </code></pre>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false"
                  aria-controls="panelsStayOpen-collapseThree">
                  <img src="css\p1_images\PudeÅ‚kowy cen dzielnice mini.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
sns.set_style("ticks")
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)

chart  = sns.boxplot(data=df.drop(df[df.Cena >= 2500000].index), y='Cena', x='lokalizacja', 
    order=df.drop(df[df.Cena >= 2500000].index).groupby('lokalizacja')
    .mean()['Cena'].sort_values(ascending=True).index.tolist(),
    )

f = lambda x, pos: f'{x/10**6:,.1f}M'
chart.yaxis.set_major_formatter(ticker.FuncFormatter(f))

chart.set(xlabel='Dzielnica', ylabel='Cena')
chart.set_title('Wykres pudeÅ‚kowy cen w zaleÅ¼noÅ›ci od dzielnicy')
                  </code></pre>
                </div>
              </div>
            </div>

            <li class="opis_wiz">
              NajtaÅ„sza oferta to lokal usÅ‚ugowy w WesoÅ‚ej, o powierzchni 20 mÂ², ktÃ³ry moÅ¼e peÅ‚niÄ‡ funkcjÄ™ mieszkalnÄ…, do wykoÅ„czenia, niecaÅ‚e 13 km od stacji ÅšwiÄ™tokrzyska. Niska cena wydaje siÄ™ uzasadniona.
            </li>
          </div>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseFive" aria-expanded="true" aria-controls="panelsStayOpen-collapseFive">
<img src="css\p1_images\Histogram powierzchni.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseFive" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
fig, ax = plt.subplots(figsize=(9, 6))
ax.set_ylabel("CzÄ™stoÅ›Ä‡")
chart =sns.histplot(df['powierzchnia'], bins=57, edgecolor=None, element='step', color='navy')
chart.set_title('Histogram powierzchni')
chart.set(xlabel='Powierzchnia [mÂ²]', ylabel='CzÄ™stoÅ›Ä‡')
                                      </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Wykres wyraÅºnie wspÃ³Å‚ksztaÅ‚tny do histogramu cen - wiÄ™kszoÅ›Ä‡ ofert to mieszkania do 100 mÂ² w cenie do 1-1,2 mil zÅ‚.           
          </li>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSix" aria-expanded="true" aria-controls="panelsStayOpen-collapseSix">
<img src="css\p1_images\XY sq i n pokoi.png" style="width:100%" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseSix" class="accordion-collapse collapse">
                <div class="accordion-body">
                  <pre><code class="language-python">
# Kod tylko dla lewego wykresu
chart = sns.jointplot(data=df, x='powierzchnia', y='Cena', 
                      hue='zabudowa', kind='scatter', cmap='Mako', 
ylim=(-1500000, 16000000), xlim=(-50, 500), linewidth = 0, height=8,
palette={"apartamentowiec": "slateblue", 
         "blok": "tan", 
         "kamienica": "mediumaquamarine", 
         "dom": "crimson"})
f = lambda x, pos: f'{x/10**6:,.0f}M'
chart.ax_joint.yaxis.set_major_formatter(ticker.FuncFormatter(f))
chart.ax_joint.set_xlabel("Powierzchnia [mÂ²]")
chart.ax_joint.set_ylabel("Cena [zÅ‚]")
                                      </code></pre>
                </div>
              </div>
            </div>
          </div>
          <li class="opis_wiz">
            Oferta mieszkania z dwoma pokojami i powierzchniÄ… 216 mÂ² to lokal mieszkalny o powierzchni 116 mÂ² wraz z lokalem usÅ‚ugowym 100 mÂ², kÃ³ry wymaga wykoÅ„czenia. 
            <br>Oferta zostaÅ‚a usuniÄ™ta pzed modelowaniem. 
          </li>


          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseSeven" aria-expanded="true" aria-controls="panelsStayOpen-collapseSeven">
<img src="css\p1_images\Histogram zabudowa.png" alt="">                </button>
              </h2>
              <div id="panelsStayOpen-collapseSeven" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="zabudowa",
    multiple="stack",
    palette="viridis",)
chart.set_title('Rodzaj zabudowy')
chart.set(xlabel='Dzielnica', ylabel='IloÅ›Ä‡')
                  </code></pre>

                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseEight" aria-expanded="false" aria-controls="panelsStayOpen-collapseEight">
<img src="css\p1_images\Kolumnowy stan mieszkaÅ„.png" alt="">
                </button>
              </h2>
              <div id="panelsStayOpen-collapseEight" class="accordion-collapse collapse">
                <div class="accordion-body">

                  <pre><code>
fig, ax = plt.subplots(figsize=(9,6))
plt.xticks(rotation=-60)
chart = sns.histplot(
    df,
    x="lokalizacja", hue="wykonczenie",
    multiple="stack",
    palette="flare",)
chart.set_title('Stan mieszkaÅ„')
chart.set(xlabel='Dzielnica', ylabel='IloÅ›Ä‡')
                  </code></pre>

                </div>
              </div>
            </div>
          </div>

<br>
          
          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseTen" aria-expanded="true" aria-controls="panelsStayOpen-collapseTen">
<img src="css\p1_images\OdlegÅ‚oÅ›ci.png" style="width: 100%;">                </button>
              </h2>
              <div id="panelsStayOpen-collapseTen" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,6))
  sns.histplot(df['Dystans do Swietokrzyskiej'],  
                      label="L do stacji ÅšwiÄ™tokrzyska", 
                      kde=False, element="step", 
                      alpha=0.3)
  sns.histplot(df["dystans do najblizszej stacji [m]"],  
                      label="L do najbliÅ¼szej stacji metra [m]", 
                      kde=False, element="step", alpha=0.3)
  ax.set_title('OdlegÅ‚oÅ›ci do stacji metra')
  ax.set(xlabel='OdlegÅ‚oÅ›Ä‡ [m]', ylabel='CzÄ™stoÅ›Ä‡')
  plt.legend() 
</code></pre>                </div>
              </div>
            </div>
          </div>

<br>

          <div class="accordion" id="accordionPanelsStayOpenExample">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                data-bs-target="#panelsStayOpen-collapseNine" aria-expanded="true" aria-controls="panelsStayOpen-collapseNine">
<img src="css\p1_images\Korelacje.png" style="width: 100%;">                </button>
              </h2>
              <div id="panelsStayOpen-collapseNine" class="accordion-collapse collapse">
                <div class="accordion-body">
<pre><code>
  fig, ax = plt.subplots(figsize=(9,8))
sns.heatmap(df.corr(), cmap='RdBu_r', annot=True, annot_kws={"fontsize":7},
    fmt=".2f",
    xticklabels=['Cena', 'Powierzchnia', 'Liczba pokojÃ³w', 'PiÄ™tro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbliÅ¼szej stacji', 'Balkon', 'OgrÃ³d', 'Taras', 'Do remontu',
    'Do wykoÅ„czenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wtÃ³rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'],
    yticklabels=['Cena', 'Powierzchnia', 'Liczba pokojÃ³w', 'PiÄ™tro', 'Parking', 'Rok budowy', 
    'Winda', '[m] do Centrum', '[m] do najbliÅ¼szej stacji', 'Balkon', 'OgrÃ³d', 'Taras', 'Do remontu',
    'Do wykoÅ„czenia', 'Do zamieszkania', 'Rynek pierwotny', 'Rynek wtÃ³rny', 'Apartamentowiec', 'Blok', 'Dom', 'Kamienica'])
</code></pre>                </div>
              </div>
            </div>
          </div>


          <br>
          <div class="wiz_uwagi">
            <h4 id="uwagi-header">Uwagi dotyczÄ…ce korelacji</h4>
            <li>Wykres korelacji reprezentuje zaleÅ¼noÅ›ci wartoÅ›ci miÄ™dzy atrybutami. JeÅ¼eli wartoÅ›Ä‡ jest pozytywna, oznacza to Å¼e wraz ze wzrostem wartoÅ›ci w danej kolumnie, wartoÅ›Ä‡ w danym wierszu rÃ³wnieÅ¼ wzroÅ›nie, jeÅ¼eli bÄ™dzie ujemna, zmaleje. WartoÅ›ci korelacji bliÅ¼ej 0 oznaczajÄ…, Å¼e  atrybut ma maÅ‚e znaczenie. 
            </li>
            <li>Pierwszym wartym zaznaczenia wnioskiem jest fakt, Å¼e atrybuty odlegÅ‚oÅ›ci do centrum i najbliÅ¼szej stacji metra majÄ… niemaÅ‚e znaczenie - sÄ… to jedne z wiÄ™kszych wynikÃ³w (-0,24 i -0,2) po najwyÅ¼ej korelujÄ…cymi z cenÄ… powierzchniÄ… i liczbÄ… pokoi. 
            </li>
            <li>Innymi znaczÄ…cymi atrybutami sÄ… rodzaje zabudowy, w szczegÃ³lnoÅ›ci blok (cena maleje) i apartamentowiec (cena roÅ›nie). Znaczna wiÄ™kszoÅ›Ä‡ najdroÅ¼szych mieszkaÅ„ byÅ‚a apartamentowcami.
            </li>
            <li>Dom okazaÅ‚ siÄ™ nieistotny, trzeba rÃ³wnieÅ¼ zaznaczyÄ‡, Å¼e iloÅ›Ä‡ ofert domÃ³w (tu poÅ‚Ä…czonych domÃ³w wolnostojÄ…cych i szeregowcÃ³w) byÅ‚a nieduÅ¼a. MoÅ¼liwe Å¼e uwzglÄ™dnienie terenÃ³w takich jak podmiejskie rejony Piaseczna z wieloma osiedlami domÃ³w jednorodzinnych daÅ‚yby bardziej interesujÄ…ce wyniki. 
            </li>
            <li>Co prawda jest zauwaÅ¼alna bardzo duÅ¼a korelacja miÄ™dzy rokiem budowy a kamienicÄ…, moÅ¼na przypuszczaÄ‡ Å¼e powinna byÄ‡ jeszcze wiÄ™ksza. WÅ›rÃ³d ofert znajdowaÅ‚o siÄ™ kilka kamienic, gdzie za rok budowy najprawdopodobniej podano rok generalnego remontu.
            </li>
            <li>InteresujÄ…ca jest rÃ³wnieÅ¼ bliska zeru korelacja miÄ™dzy tarasem a domem. Taras ma rÃ³wnieÅ¼ doÅ›Ä‡ wysokÄ… korelacjÄ™ z cenÄ…, powierzchniÄ… i apartamentowcem, wiÄ™c moÅ¼liwe jest Å¼e dotyczÄ… one np. rozlegÅ‚ych tarasÃ³w na dachach budynkÃ³w.
            </li>
            <li>Stan mieszkania okazaÅ‚ siÄ™ rÃ³wnieÅ¼ doÅ›Ä‡ nieznaczny w stosunku do ceny, niemniej rozkÅ‚ad korelacji - negatywny dla stanu do remontu i do wykoÅ„czenia i pozytywny dla stanu do zamieszkania jest logiczny.
            </li>
          </div>
        
          </div>

          <div class="tresc modelowanie">
            <h4 id="modelowanie-header">Modelowanie</h4>
            Modelowanie przeprowadzono przy pomocy prostej regresji liniowej z biblioteki scikit-learn oraz sieci neuronowej Keras. Po oczyszczeniu danych pozostaÅ‚o tylko dobranie danych dla wytrenowania modelu. 
            <br><br>
            
            Najpierw usuniÄ™to kolumny 'pierwotny' (rynek) i 'do zamieszkania', poniewaÅ¼ nie sÄ… one juÅ¼ potrzebne - 0 w kolumnie 'do wykoÅ„czenia' i 0 w kolumnie 'do remontu' wystarczÄ…. Przy skorzystaniu z funkcji get_dummies moÅ¼na skorzystaÄ‡ z drop_first=True by osiÄ…gnÄ…Ä‡ ten efekt. Tu zostaÅ‚o to zrobione dopiero na tym etapie w celu jaÅ›niejszej wizualizacji korelacji. 
            <br><br>
            We wszystkich modelach test_size w Train-Test-Split ustawiono na 0.3 co oznacza, Å¼e 70% danych zostaÅ‚o przeznaczone na wytrenowanie modelu, a 30% na sprawdzenie. 
            <br><br>
            Do ewaluacji modelu wykorzystano:
            <li>MAE - Mean Absolute Error - Å›redni bÅ‚Ä…d bezwzglÄ™dny</li>
            <li>RMSE - Root Mean Squared Error - pierwiastek bÅ‚Ä™du Å›redniokwadratowego - bardziej wyczulony na duÅ¼e bÅ‚Ä™dy, 
            moÅ¼na go Å‚atwo interpretowaÄ‡ dziÄ™ki pierwiastkowi (bez pierwiastka znany jako MSE)</li>
            <li>RÂ² - wspÃ³Å‚czynnik determinacji - osiÄ…ga wartoÅ›ci od 0, do 1, wyÅ¼sza wartoÅ›Ä‡ oznacza lepiej dopasowanÄ… liniÄ™ regresji</li>
            <br>

            $$MAE=\frac{1}{n}\sum^n_{i=1}|y_i-\hat{y_i}|$$	
            <!-- MAE - Å›redni bÅ‚Ä…d bezwzglÄ™dny - Å›rednia z sumy wartoÅ›ci bezwzglÄ™dnych bÅ‚Ä™dÃ³w -->
            $$RSME=\sqrt{\frac{1}{n}\sum^n_{i=1}(y_i-\hat{y_i})^2}$$
            $$R^2=1-\frac{\sum^n_{i=1}(y_i-\hat{y_i})^2}{\sum^n_{i=1}(y_i-\overline{y_i})^2}$$
            gdzie: 
            <li>\((y_i-\hat{y_i})^2\) to tzw. residuals, potÄ™ga rÃ³Å¼nicy miÄ™dzy wartoÅ›ciÄ… prawdziwÄ… a wartoÅ›ciÄ… przewidywanÄ…</li>
            <li>\((y_i-\overline{y_i})^2\) to wariancja, potÄ™ga rÃ³Å¼nicy miÄ™dzy prawdziwÄ… wartoÅ›ciÄ… a Å›redniÄ… tego rodzaju wartoÅ›ci</li>
            <!-- RMSE - pierwiastek bÅ‚Ä™du Å›redniokwadratowego - bardziej wyczulony na duÅ¼e bÅ‚Ä™dy, moÅ¼na go Å‚atwo interpretowaÄ‡ dziÄ™ki pierwiastkowi (bez pierwiastka znany jako MSE) -->
            <br>MAE, MSE i RMSE sÄ… wartoÅ›ciami, ktÃ³re chcemy zminimalizowaÄ‡ podczas budowania modelu.
            <br><br>Modelowanie przeprowadzono dla kilku rÃ³Å¼nych przedziaÅ‚Ã³w - najpierw usuniÄ™to mieszkania powyÅ¼ej 9 000 000 zÅ‚. Wyniki przedstawiono poniÅ¼ej. 


            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 9 mln zÅ‚</h5>
                    <li>MAE: 251 527 [zÅ‚]</li>
                    <li>RMSE: 393 270 [zÅ‚]</li>
                    <li>RÂ²: 0.80</li>     
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 365 607 zÅ‚</small></p>              
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\9mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 9 mln zÅ‚</h5>
                    <li>MAE: 697 458 [zÅ‚]</li>
                    <li>RMSE: 1 106 752 [zÅ‚]</li>
                    <li>RÂ²: 0.75</li>                    
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 531320 zÅ‚</small></p>
                  </div>
                </div>
              </div>
            </div>
            <br>
            Mimo wysokiego wyniku RÂ² taki model nie jest zbyt praktyczny - Å›rednie bÅ‚Ä™dy sÄ… zbyt wysokie, w szczegÃ³lnoÅ›ci 
            w przypadku RMSE dla sieci neuronowej TensorFlow gdzie RMSE wynosi ponad 1 mln zÅ‚, czyli trochÄ™ wiÄ™cej niÅ¼ Å›rednia cena mieszkania w zestawie danych. 
            Jest tu teÅ¼ wyraÅºnie widoczny efekt badania RMSE, ktÃ³ry jest bardziej 'wyczulony' na wartoÅ›ci mocno odbiegajÄ…ce od wartoÅ›ci Å›rednich. 
            Dlatego w kolejnym podejÅ›ciu przedziaÅ‚ danych ograniczono do cen od 125 000 do 2 500 000 mln zÅ‚. <br><br>
             
            
            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil reg.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja liniowa <br> do 2,5 mln zÅ‚</h5>
                    <li>MAE: 147 788 [zÅ‚]</li>
                    <li>RMSE: 211 835 [zÅ‚]</li>
                    <li>RÂ²: 0.75</li>     
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 494 160 zÅ‚</small></p>              
                  </div>
                </div>
              </div>
            </div>

            <div class="card mb-6" style="max-width: 900px;">
              <div class="row g-0">
                <div class="col-md-8">
                  <img src="css\p1_images\2mil keras.png" class="img-fluid rounded-start" alt="...">
                </div>
                <div class="col-md-4">
                  <div class="card-body">
                    <h5 class="card-title">Regresja TensorFlow<br> do 2,5 mln zÅ‚</h5>
                    <li>MAE: 412 673 [zÅ‚]</li>
                    <li>RMSE: 557 260 [zÅ‚]</li>
                    <li>RÂ²: 0.74</li>                    
                    <p class="card-text"><small class="text-body-secondary">Koszt mojego mieszkania: 531320 zÅ‚</small></p>
                  </div>
                </div>
              </div>
            </div>

            <br><br>

            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Mieszkanie</th>
                  <th scope="col">LR <9 mln zÅ‚</th>
                  <th scope="col">TF <9 mln zÅ‚</th>
                  <th scope="col">LR <2,5 mln zÅ‚</th>
                  <th scope="col">TF <2,5 mln zÅ‚</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">37 mÂ², blok, WÅ‚ochy</th>
                  <td>365 607 zÅ‚</td>
                  <td>531 320 zÅ‚</td>
                  <td>494 160 zÅ‚</td>
                  <td>531 320 zÅ‚</td>
                </tr>
                <tr>
                  <th scope="row">54 mÂ², apartmanet, Kabaty</th>
                  <td>394 026 zÅ‚</td>
                  <td>628 492 zÅ‚</td>
                  <td>577 780 zÅ‚</td>
                  <td>667 709 zÅ‚</td>
                </tr>
                <tr>
                  <th scope="row">96 mÂ², apartmanet, Natolin</th>
                  <td>1 501 197 zÅ‚</td>
                  <td>1 358 248 zÅ‚</td>
                  <td>1 397 107 zÅ‚</td>
                  <td>1 519 427 zÅ‚</td>

                </tr>
              </tbody>
            </table>

          </div>

        </div>
      </span>
        <div class="col-md-4"> <!-- SIDEBAR -->
          <div class="sticky">
            <p>Nawigacja:</p>
            <a href="#wstep-header">1. WstÄ™p</a> <br>
            <a href="#zebranie_danych-header">2. Zebranie danych</a> <br>
            <a href="#QGIS-header">3. Przetworzenie danych w QGIS</a> <br>
            <a href="#pandas-header">4. Oczyszczenie danych w Pandas</a> <br>
            <a href="#wizualizacja-header">5. Wizualizacja danych</a> <br>
            <a href="#uwagi-header" style="margin-left:15px">Uwagi dotyczÄ…ce korelacji</a> <br>
            <a href="#modelowanie-header">6. Modelowanie</a> <br>
          </div>
        </div>
    </div>
      

    <script>hljs.highlightAll();</script>
  </body>
</html>